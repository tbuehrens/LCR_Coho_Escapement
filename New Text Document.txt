SELECT p.id <https://gcc02.safelinks.protection.outlook.com/?url=http%3A%2F%2Fp.id%2F&data=05%7C01%7CThomas.Buehrens%40dfw.wa.gov%7C926c8be77d454a12a50008db19e74fff%7C11d0e217264e400a8ba057dcc127d72d%7C0%7C0%7C638132254107907585%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000%7C%7C%7C&sdata=Om5sasaaiyXF4duNCe65CvuPCYehQZ4PSfzod%2FLxdBg%3D&reserved=0> , p.stock_number, p.population_name, p.species_id, p.esu_id, p.esa_listing_date, p.region_id,
    MIN(g.recovery_goal) AS recovery_goal_min,
    MAX(g.recovery_goal) AS recovery_goal_max,
    s.name <https://gcc02.safelinks.protection.outlook.com/?url=http%3A%2F%2Fs.name%2F&data=05%7C01%7CThomas.Buehrens%40dfw.wa.gov%7C926c8be77d454a12a50008db19e74fff%7C11d0e217264e400a8ba057dcc127d72d%7C0%7C0%7C638132254107907585%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000%7C%7C%7C&sdata=NyvWCFWxCA1HdMWwBxW%2FYoWg4IBL9gtXYrsKvgxLGnc%3D&reserved=0>  AS species_name, esu.name <https://gcc02.safelinks.protection.outlook.com/?url=http%3A%2F%2Fesu.name%2F&data=05%7C01%7CThomas.Buehrens%40dfw.wa.gov%7C926c8be77d454a12a50008db19e74fff%7C11d0e217264e400a8ba057dcc127d72d%7C0%7C0%7C638132254107907585%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000%7C%7C%7C&sdata=EWQBT0XUmXLYBdSyFcrNiGRjOxVNGAFdfm0fggDeYnA%3D&reserved=0>  AS esu_name,
    (
        (
            SUM(IF(e.production_type IN ("Natural", "Composite", "Hatchery", "NA"), e.abundance_quantity, 0)) -
            SUM(IF(e.production_type IN ("Natural", "NA"), e.abundance_quantity, 0))
        ) /
        SUM(IF(e.production_type IN ("Natural", "Composite", "Hatchery", "NA"), e.abundance_quantity, 0))
    ) AS percent_hatchery_spawners,
    "Adult" AS abundance_type
FROM abundance_population p
    INNER JOIN abundance_escapement e ON e.population_id = p.id <https://gcc02.safelinks.protection.outlook.com/?url=http%3A%2F%2Fp.id%2F&data=05%7C01%7CThomas.Buehrens%40dfw.wa.gov%7C926c8be77d454a12a50008db19e74fff%7C11d0e217264e400a8ba057dcc127d72d%7C0%7C0%7C638132254107907585%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000%7C%7C%7C&sdata=Om5sasaaiyXF4duNCe65CvuPCYehQZ4PSfzod%2FLxdBg%3D&reserved=0> 
    INNER JOIN abundance_region r ON r.id <https://gcc02.safelinks.protection.outlook.com/?url=http%3A%2F%2Fr.id%2F&data=05%7C01%7CThomas.Buehrens%40dfw.wa.gov%7C926c8be77d454a12a50008db19e74fff%7C11d0e217264e400a8ba057dcc127d72d%7C0%7C0%7C638132254107907585%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000%7C%7C%7C&sdata=cRflWttooB4VIMASQkUq%2F%2BOygJlvI6TxwoiSt9Zd2So%3D&reserved=0>  = p.region_id
    LEFT JOIN abundance_goal g ON g.population_id = p.id <https://gcc02.safelinks.protection.outlook.com/?url=http%3A%2F%2Fp.id%2F&data=05%7C01%7CThomas.Buehrens%40dfw.wa.gov%7C926c8be77d454a12a50008db19e74fff%7C11d0e217264e400a8ba057dcc127d72d%7C0%7C0%7C638132254107907585%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000%7C%7C%7C&sdata=Om5sasaaiyXF4duNCe65CvuPCYehQZ4PSfzod%2FLxdBg%3D&reserved=0> 
    INNER JOIN abundance_species s ON s.id <https://gcc02.safelinks.protection.outlook.com/?url=http%3A%2F%2Fs.id%2F&data=05%7C01%7CThomas.Buehrens%40dfw.wa.gov%7C926c8be77d454a12a50008db19e74fff%7C11d0e217264e400a8ba057dcc127d72d%7C0%7C0%7C638132254107907585%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000%7C%7C%7C&sdata=lbM6jC4mdYTqvVftPU0YMoUEwYVCNGMa8wi36mDxg%2BQ%3D&reserved=0>  = p.species_id
    INNER JOIN abundance_esu esu ON esu.id <https://gcc02.safelinks.protection.outlook.com/?url=http%3A%2F%2Fesu.id%2F&data=05%7C01%7CThomas.Buehrens%40dfw.wa.gov%7C926c8be77d454a12a50008db19e74fff%7C11d0e217264e400a8ba057dcc127d72d%7C0%7C0%7C638132254107907585%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000%7C%7C%7C&sdata=OlKD4id3nmz4xmUdwEdFCTDQ027V0wA0chNEkwjlwr4%3D&reserved=0>  = p.esu_id WHERE e.report_types LIKE "%SOS%" AND p.esu_id IN ([LIST_OF_ESU_IDS])
    AND esu.display
    GROUP BY p.id <https://gcc02.safelinks.protection.outlook.com/?url=http%3A%2F%2Fp.id%2F&data=05%7C01%7CThomas.Buehrens%40dfw.wa.gov%7C926c8be77d454a12a50008db19e74fff%7C11d0e217264e400a8ba057dcc127d72d%7C0%7C0%7C638132254107907585%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000%7C%7C%7C&sdata=Om5sasaaiyXF4duNCe65CvuPCYehQZ4PSfzod%2FLxdBg%3D&reserved=0>
ORDER BY SUM(e.abundance_quantity IS NOT NULL) > 0 DESC, p.population_name